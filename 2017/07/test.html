<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link crossorigin="anonymous" href="../../js/frameworks.css"  media="all" rel="stylesheet" />
    <link crossorigin="anonymous" href="../../js/github.css"  media="all" rel="stylesheet" />
    <title>Title</title>

</head>
<body>

<div class="container new-discussion-timeline experiment-repo-nav">
    <div class="repository-content">


        <div id="wiki-wrapper" class="wiki-wrapper page">
            <div class="gh-header">
                <div class="gh-header-show">
                    <!--<div class="gh-header-actions">-->
                        <!--<a href="/qc1iu/simple-net/wiki/Linux-firewall/_edit" class="btn btn-sm ">Edit</a>-->
                        <!--<a href="/qc1iu/simple-net/wiki/_new" class="btn btn-sm btn-primary">New Page</a>-->
                    <!--</div>-->
                    <h1 class="gh-header-title instapaper_title">Linux firewall</h1>
                    <div class="gh-header-meta">
                        qqq edited this page <relative-time datetime="2017-06-29T04:31:19Z">Jun 29, 2017</relative-time>
                        &middot;
                        <!--<a href="/qc1iu/simple-net/wiki/Linux-firewall/_history" class="history">-->
                            <!--1 revision-->
                        <!--</a>-->
                    </div>
                </div>
            </div>
            <div id="wiki-content" class="wiki-content">
                <!--<div class="has-rightbar">-->

                    <!--&lt;!&ndash;<div id="wiki-rightbar" class="wiki-rightbar">&ndash;&gt;-->
                        <!--&lt;!&ndash;&lt;!&ndash;<div class="wiki-pages-box readability-sidebar boxed-group flush js-wiki-pages-box " role="navigation">&ndash;&gt;&ndash;&gt;-->

                            <!--&lt;!&ndash;&lt;!&ndash;<h3 class="js-wiki-toggle-collapse wiki-auxiliary-content">&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;<svg aria-hidden="true" class="octicon octicon-triangle-down caret-expanded" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M0 5l6 6 6-6z"/></svg>&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;<svg aria-hidden="true" class="octicon octicon-triangle-right caret-collapsed" height="16" version="1.1" viewBox="0 0 6 16" width="6"><path fill-rule="evenodd" d="M0 14l6-6-6-6z"/></svg>&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;Pages <span class="Counter">2</span>&ndash;&gt;&ndash;&gt;-->
                            <!--&lt;!&ndash;&lt;!&ndash;</h3>&ndash;&gt;&ndash;&gt;-->
                            <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<div class="boxed-group-inner wiki-auxiliary-content wiki-auxiliary-content-no-bg">&ndash;&gt;&ndash;&gt;&ndash;&gt;-->

                                <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<ul class="wiki-pages" data-filterable-for="wiki-pages-filter" data-filterable-type="substring">&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                    <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<li>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                        <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<strong><a href="/qc1iu/simple-net/wiki" class="wiki-page-link">Home</a></strong>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                    <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;</li>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                    <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<li>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                        <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;<strong><a href="/qc1iu/simple-net/wiki/Linux-firewall" class="wiki-page-link">Linux firewall</a></strong>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                    <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;</li>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                                <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;</ul>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->
                            <!--&lt;!&ndash;&lt;!&ndash;&lt;!&ndash;</div>&ndash;&gt;&ndash;&gt;&ndash;&gt;-->

                        <!--&lt;!&ndash;&lt;!&ndash;</div>&ndash;&gt;&ndash;&gt;-->

                        <!--&lt;!&ndash;<div class="boxed-group flush">&ndash;&gt;-->
                            <!--&lt;!&ndash;<a href="/qc1iu/simple-net/wiki/_new?wiki%5Bname%5D=_Sidebar" class="wiki-empty-box"><svg aria-hidden="true" class="octicon octicon-plus" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5z"/></svg> Add a custom sidebar</a>&ndash;&gt;-->
                        <!--&lt;!&ndash;</div>&ndash;&gt;-->

                        <!--&lt;!&ndash;<div class="clone-url">&ndash;&gt;-->
                            <!--&lt;!&ndash;<h5>Clone this wiki locally</h5>&ndash;&gt;-->
                            <!--&lt;!&ndash;<div class="input-group js-zeroclipboard-container">&ndash;&gt;-->
                                <!--&lt;!&ndash;<input type="text" class="form-control input-sm text-small text-gray input-monospace js-url-field js-zeroclipboard-target" aria-label="Clone URL for this wiki"&ndash;&gt;-->
                                       <!--&lt;!&ndash;value="https://github.com/qc1iu/simple-net.wiki.git" readonly="readonly">&ndash;&gt;-->
                                <!--&lt;!&ndash;<span class="input-group-button">&ndash;&gt;-->
            <!--&lt;!&ndash;<button aria-label="Copy to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button tooltipped tooltipped-s" data-copied-hint="Copied!" type="button"><svg aria-hidden="true" class="octicon octicon-clippy" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"/></svg></button>&ndash;&gt;-->
          <!--&lt;!&ndash;</span>&ndash;&gt;-->
                            <!--&lt;!&ndash;</div>&ndash;&gt;-->


                        <!--&lt;!&ndash;</div>&ndash;&gt;-->
                    <!--</div>-->

                    <div id="wiki-body" class="wiki-body gollum-markdown-content instapaper_body">
                        <div class="markdown-body">
                            <h1>
                                <a id="user-content-overview" class="anchor" href="#overview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h1>
                            <p>两种类型的防火墙：</p>
                            <ol>
                                <li>packet filter</li>
                                <li>application filter</li>
                            </ol>
                            <h1>
                                <a id="user-content-lab-task" class="anchor" href="#lab-task" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab Task</h1>
                            <h2>
                                <a id="user-content-task1" class="anchor" href="#task1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task1</h2>
                            <p>利用ufw进行防火墙配置</p>
                            <p>用seed作为虚拟机A,需要另外一个虚拟机B</p>
                            <h3>
                                <a id="user-content-prevent-a-from-doing-telnet-to-machine-b" class="anchor" href="#prevent-a-from-doing-telnet-to-machine-b" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prevent A from doing telnet to Machine B</h3>
                            <p>在seed里面无法用telnet连接到任何一台机器，原因未知，待解决。</p>
                            <p><strong>原因找到，　seed中默认开启了telnet服务，我自己的机器默认没有开启telnet服务。　<a href="https://stackoverflow.com/questions/34389620/telnet-unable-to-connect-to-remote-host-connection-refused">解决方法</a></strong></p>
                            <h3>
                                <a id="user-content-prevent-b-from-doing-telnet-to-machine-a" class="anchor" href="#prevent-b-from-doing-telnet-to-machine-a" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prevent B from doing telnet to Machine A.</h3>
                            <p>在seed中使用ufw配置防火墙</p>
                            <p>使用：</p>
                            <pre><code>sudo ufw reject telent
</code></pre>
                            <p>可以拒绝一切telnet请求。</p>
                            <p>ufw deny与reject的区别:refect会返回一个reject信息。deny从实验现象看是直接将请求包丢弃。</p>
                            <p>拒绝特定机器B的telnet</p>
                            <pre><code>sudo ufw reject proto tcp from B'ip to any port 23
</code></pre>
                            <p>实验后机器B无法用telnet连接A,但是物理机C仍然可以。</p>
                            <h3>
                                <a id="user-content-prevent-a-from-visiting-an-external-web-site-you-can-choose-any-web-site-that-you-like-to-block-but-keep-in-mind-some-web-servers-have-multiple-ip-addresses" class="anchor" href="#prevent-a-from-visiting-an-external-web-site-you-can-choose-any-web-site-that-you-like-to-block-but-keep-in-mind-some-web-servers-have-multiple-ip-addresses" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prevent A from visiting an external web site. You can choose any web site that you like to block, but keep in mind, some web servers have multiple IP addresses</h3>
                            <p>选取网站www.ustc.edu.cn 进行屏蔽。</p>
                            <ol>
                                <li>使用ping查看目标的ip地址。</li>
                                <li>sudo ufw reject out to '目标ip'</li>
                            </ol>
                            <p>reject和deny都可以起到屏蔽的作用。通过实验观察，deny使得浏览器一直尝试请求页面，reject浏览器会立刻返回连接不可用的提示。</p>
                            <h2>
                                <a id="user-content-task2" class="anchor" href="#task2" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task2</h2>
                            <p>按照实验文档3.1的提示，编写一个简单的LKM.</p>
                            <p>实验结果：</p>
                            <p>在我的物理机上，当执行<code>sudo insmod hello.ko</code>时，syslog中出现Hello World.符合预期。当执行<code>sudo rmmod hello</code>时，syslog中并没有出现Bye-bye World，　而是当第二次装载模块时，会将Bye-bye World和Hello World一起写在log上。</p>
                            <p>在虚拟机seed中，syslog没有记录，但是通过<code>lsmod</code>查看，模块的确是装载了。</p>
                            <h2>
                                <a id="user-content-task3" class="anchor" href="#task3" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task3</h2>
                            <p>先配置seed环境。</p>
                            <ol>
                                <li>利用ufw阻止一切对外的telnet请求 sudo ufw reject out telnet</li>
                                <li>利用ufw阻止对　www.ustc.edu.cn　的网络访问 sudo ufw reject out to '目标IP'</li>
                            </ol>
                            <p><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/">关于ssh</a></p>
                            <h3>
                                <a id="user-content-task3a" class="anchor" href="#task3a" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task3.a</h3>
                            <p>虚拟机中为seed，作为机器A,物理机为机器B。</p>
                            <p>在seed中使用ssh配置转发端口</p>
                            <pre><code>ssh -L 8000:B's IP:23 username@B's IP
</code></pre>
                            <p>此命令将机器B作为代理，将本地端口８０００收到的请求发到机器B,机器B会再将请求发到机器B的端口２３. 实验文档的命令</p>
                            <pre><code>ssh -L 8000:C's IP:23 username@B's IP
</code></pre>
                            <p>B会将收到的请求转发的机器C的２３端口。</p>
                            <p>试验后从seed中使用telnet连接物理机器A成功。通过ws抓包观察，通信使用的是SSH协议。</p>
                            <h3>
                                <a id="user-content-task3b" class="anchor" href="#task3b" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task3.b</h3>
                            <p>实验目的是让seed可以访问被防火墙禁止的　www.ustc.edu.cn</p>
                            <p>一种做法是与上面类似的命令</p>
                            <pre><code>ssh -L 8000:USTC's IP:80 username@B's IP
</code></pre>
                            <p>实验中介绍了另一种做法：</p>
                            <pre><code>ssh -D 9000 username@B's IP
</code></pre>
                            <p>这种做法将本地端口９０００接受的请求发往代理机器B，问题是没有告诉B如何转发。原因是有些请求包中带有相关的信息，代理服务器可以从包中获取到相关信息然后自动转发。不过用这种动态的方法无法实现telnet。</p>
                            <h3>
                                <a id="user-content-task-4" class="anchor" href="#task-4" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task 4</h3>
                            <p>应用层防火墙与传输层防火墙的区别。</p>
                            <h4>
                                <a id="user-content-task4a-using-squid" class="anchor" href="#task4a-using-squid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task4.a Using squid</h4>
                            <p>实验要求２台机器。机器A为虚拟机seed，用物理机作为机器B。在机器B上安装squid3</p>
                            <pre><code>sudo apt-get install squid3
</code></pre>
                            <p>然后启动squid。默认情况下，squid会屏蔽所有http请求。具体可以查看squid的配置文件(/etc/squid/squid.conf)。</p>
                            <p>在seed中设置firefox的代理。squid默认端口为3128。</p>
                            <p>由于代理默认拒绝所有http请求，所以浏览器得到了一个代理返回的界面。如果没有得到代理返回的界面，说明代理配置有问题。可能是浏览器代理配置错了，或者是机器B上的squid服务没有开启。</p>
                            <p><strong>注：　可以通过lsof -i:3128来查看端口的使用情况</strong></p>
                            <p>实验文档中要求配置代理，使之只能访问google。改为只能访问USTC。</p>
                            <p>更改机器B的squid的配置文件。
                                在acl标签处定义一个新的acl。</p>
                            <pre><code>acl myacl dst 218.22.21.21
</code></pre>
                            <p>在http_access标签处加入新的规则：</p>
                            <pre><code>http_access allow myacl
</code></pre>
                            <p>在seed的浏览器中实验，只能访问USTC。</p>
                            <p>在使用ufw屏蔽USTC的情况下，使用squid代理可以访问。web proxy工作在应用层。当ufw收到packet时，IP已经变为代理服务器的IP。</p>
                            <h3>
                                <a id="user-content-总结" class="anchor" href="#%E6%80%BB%E7%BB%93" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>
                            <p>重点是理解防火墙的工作原理。</p>
                            <p>Organizations, Internet Service Providers (ISPs), and countries often block their internal users from access-
                                ing certain external sites. This is called <strong>egress filtering</strong></p>

                        </div>

                        <!--<div id="wiki-footer" class="wiki-footer">-->
                            <!--<a href="/qc1iu/simple-net/wiki/_new?wiki%5Bname%5D=_Footer" class="wiki-empty-box"><svg aria-hidden="true" class="octicon octicon-plus" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5z"/></svg> Add a custom footer</a>-->
                        <!--</div>-->
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="modal-backdrop js-touch-events"></div>
</div>


</body>
</html>